import pandas as pd

# Example file names - replace these with your actual file names
file_names = ["2017arsurinaryarsenicacid.csv","2017arsurinaryarsenobetaine.csv","2017arsurinaryarsenocholine.csv","2017arsurinarydimethylarsinicacid.csv","2017arsurinarymonomethylarsonicacid.csv","2017bloodcadmium.csv","2017bloodchromium.csv","2017bloodcobalt.csv","2017bloodethyleneoxide.csv","2017bloodlead.csv","2017bloodmanganese.csv","2017bloodmercuryethyl.csv","2017bloodmercuryinorganic.csv","2017bloodmercurymethyl.csv","2017bloodmercurytotal.csv","2017bloodselenium.csv","2017bpdiastolic.csv","2017bpmaxinflation.csv","2017bppulse.csv","2017bpsystolic.csv","2017cbcbasophilnumber.csv","2017cbcbasophilpercent.csv","2017cbceosinophilnumber.csv","2017cbceosinophilpercent.csv","2017cbchematocrit.csv","2017cbchemoglobin.csv","2017cbclymphocytenumber.csv","2017cbclymphocytepercent.csv","2017cbcmeancellhemoglobinconc.csv","2017cbcmeancellhemoglobin.csv","2017cbcmeancellvolume.csv","2017cbcmeanplateletvolume.csv","2017cbcmonocytenumber.csv","2017cbcmonocytepercent.csv","2017cbcnucleatedredbloodcells.csv","2017cbcplateletcount.csv","2017cbcredbloodcellcount.csv","2017cbcredcelldistributionwidth.csv","2017cbcsegmentedneutrophilnumber.csv","2017cbcsegmentedneutrophilpercent.csv","2017cbcwhitebloodcell.csv","2017cholesterolhdl.csv","2017cholesterolldlf.csv","2017cholesteroltotal.csv","2017cholesteroltriglyceride.csv","2017dxasubcutfatmass.csv","2017dxasubcutfatvolume.csv","2017dxatotalbmc.csv","2017dxatotalbmd.csv","2017dxatotalfat.csv","2017dxatotallean.csv","2017dxatotalpercentfat.csv","2017dxavisceralfatmass.csv","2017dxavisceralfatvolume.csv","2017ferritin.csv","2017folaterbc.csv","2017glycohemoglobin.csv","2017height.csv","2017hscrp.csv","2017livermedianstiffness.csv","2017methylaceticacid.csv","2017perfluorodecanoicacid.csv","2017perfluorohexanesulfonicacid.csv","2017perfluorononanoicacid.csv","2017perfluorooctanesulfonicacid.csv","2017perfluorooctanoicacid.csv","2017perfluorooctanoicacidiso.csv","2017perfluoroundecanoicacid.csv","2017plasmafastingglucose.csv","2017sbpalp.csv","2017sbpalt.csv","2017sbpast.csv","2017sbpbicarbonate.csv","2017sbpbun.csv","2017sbpcalcium.csv","2017sbpchloride.csv","2017sbpcpk.csv","2017sbpggt.csv","2017sbpglobulin.csv","2017sbpldh.csv","2017sbposmolality.csv","2017sbpphosphorous.csv","2017sbppotassium.csv","2017sbpserumalbumin.csv","2017sbpserumglucose.csv","2017sbpserumiron.csv","2017sbpserumtriglycerides.csv","2017sbpsodium.csv","2017sbptotalbilirubin.csv","2017sbptotalprotein.csv","2017sbpuricacid.csv","2017serumcholesterol.csv","2017serumcotinine.csv","2017serumfolatetotal.csv","2017serumfolicacid.csv","2017serumfolinicacid.csv","2017serumhydroxycotinine.csv","2017seruminsulin.csv","2017serumiron.csv","2017serumlevomefolicacid.csv","2017serummefoxoxidation.csv","2017serummethenyltetrahydrofolate.csv","2017serumtetrahydrofolate.csv","2017serumtransferrinsaturation.csv","2017serumunsatironbinding.csv","2017smpfos.csv","2017transferrinrec.csv","2017urinealbumin.csv","2017urineantimony.csv","2017urinebarium.csv","2017urinecadmium.csv","2017urinecesium.csv","2017urinechromium.csv","2017urinecobalt.csv","2017urinecreatininealbuminratio.csv","2017urinecreatinine.csv","2017urinediethyldithiophosphate.csv","2017urinediethylphosphate.csv","2017urinediethylthiophosphate.csv","2017urinedimethyldithiophosphate.csv","2017urinedimethylphosphate.csv","2017urinedimethylthiophosphate.csv","2017urineflow.csv","2017urineiodine.csv","2017urinelead.csv","2017urinemanganese.csv","2017urinemercury.csv","2017urinemolybdenum.csv","2017urinenickel.csv","2017urinenitrate.csv","2017urineperchlorate.csv","2017urinethallium.csv","2017urinethiocyanate.csv","2017urinetin.csv","2017urinetotalarsenic.csv","2017urinetungsten.csv","2017urinevolume.csv","2017vitalphacarotene.csv","2017vitalphacryptoxanthin.csv","2017vitalphatocopherol.csv","2017vitaminc.csv","2017vitamind250hd2.csv","2017vitamind250hd3.csv","2017vitamindboth.csv","2017vitamindepihd3.csv","2017vitbetacryptoxanthin.csv","2017vitcisbetacarotene.csv","2017vitgammatocopherol.csv","2017vitluteinxeaxanthin.csv","2017vitretinol.csv","2017vitretinylpalmitate.csv","2017vitretinylstearate.csv","2017vittotallycopene.csv","2017vittransbetacarotene.csv","2017vittranslycopene.csv","2017weight.csv"] # Add all file names here
labels = {'2017sbpalp.csv': 'Alkaline Phosphatase (U/L)', '2017sbpalt.csv': 'ALT [Alanine Transaminase] (U/L)', '2017sbpast.csv': 'AST [Aspartate Aminotransferase] (U/L)', '2017cbcbasophilnumber.csv': 'Basophil Number (1000 cells/uL)', '2017cbcbasophilpercent.csv': 'Basophil Percent', '2017sbpbicarbonate.csv': 'Bicarbonate (mmol/L)', '2017bloodcadmium.csv': 'Blood Cadmium (ug/L)', '2017bloodchromium.csv': 'Blood Chromium (ug/L)', '2017bloodcobalt.csv': 'Blood Cobalt (ug/L)', '2017bloodethyleneoxide.csv': 'Blood Ethylene Oxide (pmol/g Hg)', '2017bloodlead.csv': 'Blood Lead (ug/dL)', '2017bloodmanganese.csv': 'Blood Manganese (ug/L)', '2017bloodmercuryethyl.csv': 'Blood Mercury - Ethyl (ug/L)', '2017bloodmercuryinorganic.csv': 'Blood Mercury - Inorganic (ug/L)', '2017bloodmercurymethyl.csv': 'Blood Mercury - Methyl (ug/L)', '2017bloodmercurytotal.csv': 'Blood Mercury - Total (ug/L)', '2017bpdiastolic.csv': 'Blood Pressure - Diastolic', '2017bpmaxinflation.csv': 'Blood Pressure - Max Inflation', '2017bppulse.csv': 'Blood Pressure - BPM (beats/min)', '2017bpsystolic.csv': 'Blood Pressure - Systolic', '2017bloodselenium.csv': 'Blood Selenium (ug/L)', '2017sbpbun.csv': 'Blood Urea Nitrogen (mg/dL)', '2017sbpcalcium.csv': 'Calcium - Total (mg/dL)', '2017cholesterolhdl.csv': 'Cholesterol - HDL (mg/dL)', '2017cholesterolldlf.csv': 'Cholesterol - LDL (mg/dL)', '2017cholesteroltotal.csv': 'Cholesterol - Total (mg/dL)', '2017cholesteroltriglyceride.csv': 'Cholesterol - Triglycerides (mg/dL)', '2017sbpchloride.csv': 'Chloride (mmol/L)', '2017sbpcpk.csv': 'CPK [Creatinine Phosphokinase] (IU/L)', '2017dxasubcutfatmass.csv': 'DXA Subcutaneous Fat Mass', '2017dxasubcutfatvolume.csv': 'DXA Subcutaneous Fat Volume', '2017dxatotalbmc.csv': 'DXA Total Bone Mineral Content', '2017dxatotalbmd.csv': 'DXA Total Bone Mineral Density', '2017dxatotalfat.csv': 'DXA Total Fat', '2017dxatotallean.csv': 'DXA Total Lean Mass', '2017dxatotalpercentfat.csv': 'DXA Total Percent Fat', '2017dxavisceralfatmass.csv': 'DXA Visceral Fat Mass', '2017dxavisceralfatvolume.csv': 'DXA Visceral Fat Volume', '2017cbceosinophilnumber.csv': 'Eosinophil Number (1000 cells/uL)', '2017cbceosinophilpercent.csv': 'Eosinophil Percent', '2017ferritin.csv': 'Ferritin (ug/L)', '2017folaterbc.csv': 'Folate - Red Blood Cells (ng/mL)', '2017sbpggt.csv': 'Gamma-Glutamyl Transferase (IU/L)', '2017glycohemoglobin.csv': 'Glycohemoglobin A1c (%)', '2017height.csv': 'Height (cm)', '2017cbchematocrit.csv': 'Hematocrit (%)', '2017cbchemoglobin.csv': 'Hemoglobin (g/dL)', '2017hscrp.csv': 'High Sensitivity C Reactive Protein', '2017sbpldh.csv': 'LDH [Lactate Dehydrogenase] (IU/L)', '2017livermedianstiffness.csv': 'Liver Median Stiffness (kPa)', '2017cbclymphocytenumber.csv': 'Lymphocyte Number (1000 cells/uL)', '2017cbclymphocytepercent.csv': 'Lymphocyte Percent', '2017cbcmeancellhemoglobin.csv': 'Mean Cell Hemoglobin (pg)', '2017cbcmeancellhemoglobinconc.csv': 'Mean Cell Hemoglobin Concentration (g/dL)', '2017cbcmeancellvolume.csv': 'Mean Cell Volume (fL)', '2017cbcmeanplateletvolume.csv': 'Mean Platelet Volume (fL)', '2017cbcplateletcount.csv': 'Mean Platelet Count (1000 cells/uL)', '2017methylaceticacid.csv': 'Methylacetic Acid', '2017cbcmonocytenumber.csv': 'Monocyte Number (1000 cells/uL)', '2017cbcmonocytepercent.csv': 'Monocyte Percent', '2017cbcnucleatedredbloodcells.csv': 'Nucleated Red Blood Cells', '2017sbposmolality.csv': 'Osmolality (mmol/Kg)', '2017sbpphosphorous.csv': 'Phosphorous (mg/dL)', '2017sbppotassium.csv': 'Potassium (mmol/L)', '2017perfluorodecanoicacid.csv': 'Perfluorodecanoic Acid', '2017perfluorohexanesulfonicacid.csv': 'Perfluorohexanesulfonic Acid', '2017perfluorononanoicacid.csv': 'Perfluorononanoic Acid', '2017perfluorooctanesulfonicacid.csv': 'Perfluorooctanesulfonic Acid', '2017perfluorooctanoicacid.csv': 'Perfluorooctanoic Acid', '2017perfluorooctanoicacidiso.csv': 'Perfluorooctanoic Acid Iso', '2017perfluoroundecanoicacid.csv': 'Perfluoroundacanoic Acid', '2017plasmafastingglucose.csv': 'Plasma Fasting Glucose', '2017cbcredbloodcellcount.csv': 'Red Blood Cell Count (million cells/uL)', '2017cbcredcelldistributionwidth.csv': 'Red Cell Distribution Width (%)', '2017cbcsegmentedneutrophilnumber.csv': 'Segmented Neutrophil Number (1000 cells/uL)', '2017cbcsegmentedneutrophilpercent.csv': 'Segmented Neutrophil Percent', '2017sbpserumalbumin.csv': 'Serum Albumin', '2017serumcholesterol.csv': 'Serum Cholesterol', '2017serumcotinine.csv': 'Serum Cotinine', '2017sbpglobulin.csv': 'Serum Globulin (g/dL)', '2017sbpserumglucose.csv': 'Serum Glucose', '2017serumiron.csv': 'Serum Iron', "2017sbpserumiron.csv": "Serum Iron SBP", '2017sbpserumtriglycerides.csv': 'Serum Triglycerides', '2017serumfolatetotal.csv': 'Serum Total Folate (ng/mL)', '2017serumfolicacid.csv': 'Serum Folic Acid', '2017serumfolinicacid.csv': 'Serum Folinic Acid', '2017serumhydroxycotinine.csv': 'Serum Hydroxycotinine', '2017seruminsulin.csv': 'Serum Insulin', '2017serumlevomefolicacid.csv': 'Serum 5-Methyl-tetrahydrofolate (nmol/L)', '2017serummefoxoxidation.csv': 'Serum Mefox Oxidation', '2017serummethenyltetrahydrofolate.csv': 'Serum Methenyl Tetrahydrofolate', '2017serumtetrahydrofolate.csv': 'Serum Tetrahydrofolate', '2017serumtransferrinsaturation.csv': 'Serum Transferrin Saturation', '2017serumunsatironbinding.csv': 'Serum Unsaturated Iron Binding', '2017smpfos.csv': 'Sm-PFOS (ng/mL)', '2017sbpsodium.csv': 'Sodium (mmol/L)', '2017sbptotalbilirubin.csv': 'Total Bilirubin', '2017sbptotalprotein.csv': 'Total Protein', '2017transferrinrec.csv': 'Transferrin Receptor (mg/L)', '2017sbpuricacid.csv': 'Uric Acid (mg/dL):2017', '2017urinealbumin.csv': 'Urine Albumin (ug/mL):2017', '2017urineantimony.csv': 'Urine Antimony', '2017urinebarium.csv': 'Urine Barium', '2017urinecadmium.csv': 'Urine Cadmium', '2017urinecesium.csv': 'Urine Cesium', '2017urinechromium.csv': 'Urine Chromium', '2017urinecobalt.csv': 'Urine Cobalt', '2017urinecreatinine.csv': 'Urine Creatinine (mg/dL)', '2017urinecreatininealbuminratio.csv': 'Urine Creatinine Albumin Ratio', '2017urinediethyldithiophosphate.csv': 'Urine Diethyldithiophosphate', '2017urinediethylphosphate.csv': 'Urine Diethylphosphate', '2017urinediethylthiophosphate.csv': 'Urine Diethylthiophosphate', '2017urinedimethylthiophosphate.csv': 'Urine Dimethylthiophosphate', '2017urinedimethyldithiophosphate.csv': 'Urine Dimethyldithiophosphate', '2017urinedimethylphosphate.csv': 'Urine Dimethylphosphate', '2017urineflow.csv': 'Urine Flow', '2017urineiodine.csv': 'Urine Iodine', '2017urinelead.csv': 'Urine Lead', '2017urinemanganese.csv': 'Urine Manganese', '2017urinemercury.csv': 'Urine Mercury', '2017urinemolybdenum.csv': 'Urine Molybdenum', '2017urinenickel.csv': 'Urine Nickel', '2017urinenitrate.csv': 'Urine Nitrate', '2017urineperchlorate.csv': 'Urine Perchlorate', '2017urinethallium.csv': 'Urine Thallium', '2017urinethiocyanate.csv': 'Urine Thiocyanate', '2017urinetin.csv': 'Urine Tin', '2017urinetotalarsenic.csv': 'Urine Total Arsenic', '2017urinetungsten.csv': 'Urine Tungsten', '2017urinevolume.csv': 'Urine Volume', '2017arsurinaryarsenicacid.csv': 'Urinary Monomethyl Arsonic Acid', '2017arsurinaryarsenobetaine.csv': 'Urinary Arsenobetaine', '2017arsurinaryarsenocholine.csv': 'Urinary Arsenocholine', '2017arsurinarydimethylarsinicacid.csv': 'Urinary Arsenous Acid', '2017arsurinarymonomethylarsonicacid.csv': 'Urinary Dimethyl Arsenic Acid', '2017vitalphacarotene.csv': 'Vitamins - Carotene', '2017vitcisbetacarotene.csv': 'Vitamins - Cis Beta Carotene', '2017vittransbetacarotene.csv': 'Vitamins - Trans Beta Carotene', '2017vitalphacryptoxanthin.csv': 'Vitamins - Cryptoxanthin', '2017vitbetacryptoxanthin.csv': 'Vitamins - Beta Cryptoxanthin', '2017vitalphatocopherol.csv': 'Vitamins - Tocopherol', '2017vitgammatocopherol.csv': 'Vitamins - Gamma Tocopherol', '2017vitluteinxeaxanthin.csv': 'Vitamins - Lutein Xeaxanthin', '2017vitretinol.csv': 'Vitamins - Retinol', '2017vitretinylpalmitate.csv': 'Vitamins - Retinyl Palmitate', '2017vitretinylstearate.csv': 'Vitamins - Retinyl Stearate', '2017vittotallycopene.csv': 'Vitamins - Total Lycopene', '2017vittranslycopene.csv': 'Vitamins - Trans Lycopene', '2017vitaminc.csv': 'Vitamin C', '2017vitamind250hd2.csv': 'Vitamin D HD2', '2017vitamind250hd3.csv': 'Vitamin D HD3', '2017vitamindboth.csv': 'Vitamin D Both', '2017vitamindepihd3.csv': 'Vitamin D Epi HD3', '2017weight.csv': 'Weight (kg)', '2017cbcwhitebloodcell.csv': 'White Blood Cell Count (1000 cells/uL)'}

# Initialize an empty DataFrame to store the merged data
merged_df = pd.read_csv("datasets/alldemographics.csv", header=0, names=["SEQN","RIAGENDR","Age","RIDRETH1","RIDRETH2","RIDRETH3","INDFMPIR","Body Mass Index"])

for file in file_names:
    label = labels[file]
    print(label)
    temp_df = pd.read_csv("datasets/" + file, header=0, names=['SEQN', 'Age', label])
    merged_df = pd.merge(merged_df, temp_df[['SEQN', label]], on='SEQN', how='outer')

# Handle missing values (optional, depends on your requirement)
# merged_df.fillna(0, inplace=True)  # Example: fill missing values with 0

# Check the merged DataFrame
print(merged_df.head())

# Save the merged DataFrame to a new CSV file (optional)
merged_df.to_csv('merged_data.csv', index=False)

